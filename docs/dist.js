"use strict";(()=>{var{console:Oe,queueMicrotask:qe,Element:pe}=globalThis,m=(e,t,r)=>({type:e,props:t,key:r}),E=m;var me={},ye={},He=m(ye,me),be={},Xe=[],Ie=pe?.prototype&&"moveBefore"in pe.prototype?"moveBefore":"insertBefore",Ye="http://www.w3.org/2000/svg",Ge=e=>Oe.error(e),ve=e=>e==null||e===!1||e==="",N=e=>typeof e=="function",K=e=>typeof e=="object"&&e!==null,we=e=>e.children,$=e=>e.children,xe=e=>(k.catch=e.catch,e.children),Se=e=>{let t=({value:r,children:o})=>{let n=k,c=M(()=>{let s={deps:new Set,value:r};return n.contexts=new Map(n.contexts).set(t,s),s});if(r!==c.value){c.value=r;for(let s of c.deps){s.state=1;let{parent:l}=s;for(;l&&l!==n&&!l.state;)l.state=2,{parent:l}=l}}return o};return t.value=e,t},Je=(e,t,r)=>N(e)||e===ye?null:e===be?r.ownerDocument.createTextNode(t.nodeValue):r.ownerDocument.createElementNS(e==="svg"?Ye:"namespaceURI"in r?r.namespaceURI:r.host.namespaceURI,e),Qe=e=>e.nodeType===e.TEXT_NODE,he=(e,t)=>{let r=e[t];return r!=null&&!K(r)},ge=(e,t,r)=>{if(Qe(e)){e.nodeValue=r.nodeValue;return}for(let o in t)if(!(o==="children"||o in r))if(o==="ref"){let n=t.ref;n&&(n.current=null)}else he(e,o)?e[o]="":e.removeAttribute(o);for(let o in r)if(!(o==="children"||t[o]===r[o]))if(o==="ref"){let n=t.ref,c=r.ref;n&&(n.current=null),c&&(c.current=e)}else if(o==="style"&&K(r[o])){let{style:n}=e,c=K(t[o])?t[o]:{},s=r[o];for(let l in c)l in s||(n[l]="");for(let l in s)n[l]=s[l]??""}else he(e,o)?e[o]=r[o]??"":r[o]!=null?e.setAttribute(o,r[o]):e.removeAttribute(o)},k=null,Y=0,G=0,F=e=>{let t=k;t.refs??=[];let r=t.refs[G++];return r||(r={current:N(e)?e():e},t.refs.push(r)),r},P=(e,t)=>{let r=k;r.effects??=[];let o=r.effects[Y++];o?(!o.deps||!t||Ee(o.deps,t))&&(o.after=e,o.deps=t):r.effects.push({before:void 0,after:e,deps:t})},M=(e,t=Xe)=>{let r=F(()=>({value:e(),deps:t}));return Ee(r.current.deps,t)&&(r.current.value=e(),r.current.deps=t),r.current.value},L=e=>{let t=k,r=M(()=>[N(e)?e():e,o=>{let n=N(o)?o(r[0]):o;return n!==r[0]&&(r[0]=n,tt(t)),n}]);return r},Ee=(e,t)=>{if(e===t)return!1;let{length:r}=e;if(r!==t.length)return!0;for(let o=0;o<r;o++)if(e[o]!==t[o])return!0;return!1},V=e=>{let t=F(()=>e);return t.current=e,M(()=>((...r)=>t.current.apply(null,r)))},Ze=(e,t)=>{if(e===t)return!0;for(let r in e)if(e[r]!==t[r])return!1;for(let r in t)if(!(r in e))return!1;return!0},J=(e,t=Ze)=>(e.memo=t,e),re=e=>{let t=k,r=t.contexts?.get(e);return P(()=>{if(r)return r.deps.add(t),()=>r.deps.delete(t)},[r,t]),(r??e).value},et=(e,t)=>{for(;e.depth>t.depth;)if(e=e.parent,e===t)return 1;for(;t.depth>e.depth;)if(t=t.parent,t===e)return-1;for(;e.parent!==t.parent;)e=e.parent,t=t.parent;return e.index-t.index},tt=e=>{if(e.state===1||e.state===3)return;let{queues:t}=e,{updates:r}=t;r.length===0&&qe(()=>{let o=r.sort(et);t.updates=[];for(let n=0;n<o.length;n++){let c=o[n];c.state===1&&oe(c)}Te(t)}),r[r.length]=e,e.state=1},rt=e=>{let{children:t}=e.props,r=e.type;if(N(r)){let o=[k,Y,G];k=e,Y=0,G=0;try{t=r(e.props)}catch(n){t=null,e.catch(n)}finally{[k,Y,G]=o}}return ve(t)?[]:Array.isArray(t)?t:[t]},ot=e=>ve(e)?He:Array.isArray(e)?m(we,{children:e}):K(e)&&"type"in e&&"props"in e&&"key"in e&&(typeof e.type=="string"||N(e.type))&&K(e.props)?e:m(be,{nodeValue:e}),ke=e=>{let{child:t,state:r}=e;if(r===1)oe(e);else if(r===2)for(e.state=0;t;t=t.sibling)ke(t)},Ce=({child:e,node:t})=>{if(t)return[t];let r=[];for(;e;e=e.sibling){let o=Ce(e);for(let n=0;n<o.length;n++)r[r.length]=o[n]}return r},oe=e=>{let{depth:t,queues:r}=e,{afterEffects:o,inserts:n,nodeUpdates:c}=r,s=e.child,l=s&&new Map;for(;s;s=s.sibling)l.set(s.key??s.index,s);let p=e.node??e.parentNode,g=rt(e);if(e.effects){let b=e.effects;try{for(let u=0;u<b.length;u++){let i=b[u];i.after&&i.before&&(i.before(),i.before=void 0)}}catch(u){e.catch(u)}}e.state=0,e.child=null;let f=e.node?null:e.prevNode;for(let b=0,u=null;b<g.length;++b){let i=ot(g[b]),{type:d,props:h,key:x}=i,a=l?.get(x??b),R=null,S=!1;if(a?.type===d){l.delete(x??b),a.index=b,a.sibling=null;let v=a.type,y=a.props,_=a.node;(!N(v)||!v.memo?.(y,h))&&(_&&(R=[_,y,h]),a.props=h,a.state=1),a.parentNode===p&&a.lastNode&&a.prevNode!==f&&(S=!0)}else{try{a={catch:e.catch,child:null,contexts:e.contexts,depth:t+1,effects:null,index:b,key:x,lastNode:null,node:Je(d,h,p),parent:e,parentNode:d===$?h.to:p,prevNode:d===$?h.to.lastChild:f,props:h,queues:r,refs:null,sibling:null,state:1,type:d}}catch(v){e.catch(v);continue}a.node&&(S=!0)}a.parentNode===p&&(a.prevNode=f),u?u.sibling=a:e.child=a,ke(a),R&&c.push(R),S&&n.push(a),a.parentNode===p&&a.lastNode&&(f=a.lastNode),u=a}if(e.lastNode=e.node??f??null,l)for(let b of l.values())Re(b);e.effects&&o.push(e)},Re=(e,t=!0)=>{e.state=3;let{effects:r,child:o,props:n,node:c}=e;if(r)try{for(let l=0;l<r.length;l++){let p=r[l];p.before&&(p.before(),p.before=void 0)}}catch(l){e.catch(l)}let s=t&&!c;for(;o;o=o.sibling)Re(o,s||o.type===$);c&&(n.ref&&(n.ref.current=null),t&&e.queues.removes.push(c))},Te=e=>{let{removes:t,inserts:r,nodeUpdates:o,afterEffects:n}=e;for(let c=0;c<t.length;c++)t[c].remove();e.removes=[];for(let c=0;c<r.length;c++){let s=r[c],{node:l,parentNode:p,prevNode:g,props:f}=s,b=g?g.nextSibling:p.firstChild;if(l&&!l.parentNode)ge(l,me,f),p.insertBefore(l,b);else{let u=Ce(s);for(let i=0;i<u.length;i++){let d=u[i];if(d===b||d.nextSibling===b)break;p[Ie](d,b)}}}e.inserts=[];for(let c=0;c<o.length;c++){let s=o[c];ge.apply(null,s)}e.nodeUpdates=[];for(let c=0;c<n.length;c++){let s=n[c],l=s.effects;try{for(let p=0;p<l.length;p++){let g=l[p];g.after&&(g.before=g.after(),g.after=void 0)}}catch(p){s.catch(p)}}e.afterEffects=[]},Me=e=>{let t={catch:Ge,child:null,contexts:null,depth:0,effects:null,index:0,key:void 0,lastNode:null,node:null,parent:null,parentNode:e,prevNode:e.lastChild,props:{children:void 0},queues:{afterEffects:[],inserts:[],nodeUpdates:[],removes:[],updates:[]},refs:null,sibling:null,state:1,type:we};return r=>{t.props.children=r,oe(t),Te(t.queues)}};var{document:z,getComputedStyle:nt,Document:Ne,ResizeObserver:Pe,window:ze,Window:st}=globalThis,{body:Ue}=z,lt=z.scrollingElement,W=ze.visualViewport??ze,ct=10,it={x:"clientWidth",y:"clientHeight"},at={x:"innerWidth",y:"innerHeight"},ft={x:"overflowX",y:"overflowY"},ne={x:"right",y:"bottom"},Ae={x:"width",y:"height"},ut={x:"scrollWidth",y:"scrollHeight"},dt={x:"scrollLeft",y:"scrollTop"},pt=({axis:e,el:t})=>{for(;(t&&=t.parentElement)&&!(t===Ue||!Ue.contains(t));){if(t[ut[e]]<=t[it[e]])continue;let r=nt(t)[ft[e]];if(r==="scroll"||r==="auto")return t}return z},De=({axis:e="y",containerRef:t,growBuffer:r=200,length:o=0,minIndex:n=0,shrinkBuffer:c=r+200})=>{let s=M(()=>({cache:{},columns:1,isRendering:!1,observed:null,observer:null,prev:{cache:{},minIndex:n,start:n},scrollParent:null,scrollTarget:null,syncUpdateCount:0,resolve:()=>{s.scrollTarget=null,s.syncUpdateCount=0}})),l=V(()=>{if(s.isRendering)return;let u=t.current,{end:i,start:d}=f;if(!u||d===i||u.children.length!==i-d)return s.resolve();let{cache:h,prev:x,scrollTarget:a}=s,R=f.start,S=[],v,y=1;for(let w of u.children){let fe=w.getBoundingClientRect(),ue=fe[Ae[e]];h[R++]=ue,S.push(ue);let de=fe[e];v==null?v=de:de===v&&++y}let _=S.sort()[Math.floor(S.length/2)];s.columns=y;let T=pt({axis:e,el:u});T!==s.scrollParent&&(s.scrollParent!==z&&s.scrollParent?.removeEventListener("scroll",l),T!==z&&T.addEventListener("scroll",l),s.scrollParent=T);let U=T instanceof Ne?lt:T,A=dt[e],Q=0,Ve=Math.min(x.minIndex,n),We=Math.max(x.start,f.start);for(let w=Ve;w<We;w+=y)Q+=(h[w]??0)-(x.cache[w]??0);if(Q&&(U[A]+=Q),s.prev={cache:{...h},minIndex:n,start:f.start},s.syncUpdateCount++>ct)return s.resolve();let Z=u.getBoundingClientRect(),O=Z[e]+f.before,q=Z[ne[e]]-f.after,ce=T instanceof Ne?{[e]:0,[ne[e]]:W instanceof st?W[at[e]]:W[Ae[e]]}:T.getBoundingClientRect(),H=ce[e],ee=ce[ne[e]],te=n+o;for(let w=n;w<te;++w)h[w]??=_;d-=(d-n)%y;let ie=(i-n)%y;for(ie&&(i+=y-ie);d-y>=n&&O>H-r;)O-=h[d-y],d-=y;for(;d<te&&O+h[d]<=H-c;)O+=h[d],d+=y;for(;i<te&&q<ee+r;)q+=h[i],i+=y;for(;i-y>=n&&q-h[i-y]>=ee+c;)q-=h[i-y],i-=y;let B=g({end:i,start:d});if(B.after!==f.after||B.before!==f.before||B.end!==f.end||B.start!==f.start)return s.isRendering=!0,b(B);if(!a)return s.resolve();let{index:D}=a;D=Math.min(n+o-1,Math.max(D,n)),D-=(D-n)%y;let ae=0;for(let w=n;w<D;w+=y)ae+=h[w];let X=U[A],_e=h[D],j=Z[e]+X-H+ae-a.buffer,I=j-(ee-H)+_e+a.buffer*2;a.align==="nearest"&&(j<I?a.align="center":X>j?a.align="start":X<I&&(a.align="end")),a.align==="start"?U[A]=j:a.align==="end"?U[A]=I:a.align==="center"&&(U[A]=(j+I)/2),U[A]===X?s.resolve():l()}),p=V(({align:u="nearest",buffer:i=0,index:d})=>{s.scrollTarget={align:u,buffer:i,index:d},l()}),g=({end:u,start:i})=>{if(r===1/0)return{after:0,before:0,end:n+o,scrollTo:p,start:n};let{cache:d,columns:h}=s,x=n+o;i-=(i-n)%h,i=Math.min(x,Math.max(i,n));let a=(u-n)%h;a&&(u+=h-a),u=Math.min(x,Math.max(u,i)),u-i<=h&&(u<x?u=Math.min(x,u+h):i>n&&(i-=h));let R=0,S=0;for(let v=n;v<x;v+=h)v<i?R+=d[v]??0:v>=u&&(S+=d[v]??0);return{after:S,before:R,end:u,scrollTo:p,start:i}},[f,b]=L({after:0,before:0,end:0,scrollTo:p,start:0});return M(()=>{Object.assign(f,g({end:f.end,start:f.start}))},[o,n]),s.observer??=Pe&&new Pe(l),P(()=>{let{observed:u,observer:i}=s,d=t.current;i&&u!==d&&(u&&i.unobserve(u),d&&i.observe(d),s.observed=d),s.isRendering=!1,l()}),P(()=>{let{observer:u}=s;return W.addEventListener("resize",l),z.addEventListener("scroll",l),()=>{u?.disconnect(),W.removeEventListener("resize",l),z.removeEventListener("scroll",l),s.scrollParent?.removeEventListener("scroll",l)}},[s,l]),f};var{clearTimeout:Le,clearInterval:ht,document:Ke,setTimeout:Be,setInterval:gt}=globalThis,C=10,$e=e=>`rgb(${32+e*12%128}, ${32+e*23%128}, ${32+e*56%128})`,mt=({children:e})=>{if(Math.random()<.005)throw new Error("red");return P(()=>{if(Math.random()<.005)throw new Error("blue");return()=>{if(Math.random()<.005)throw new Error("yellow")}}),e},yt=J(()=>E("div",{style:{background:"#fff9",borderRadius:"0.25rem",padding:"1rem"},children:["Portal: ",re(le)]})),bt=J(({x:e,y:t})=>{let r=re(le),o=M(()=>`rgb(${128+(e-t)/C*128}, ${128+(t-e)/C*128}, ${(e+t)/C/2*256})`),n=F(void 0),[c,s]=L("black"),l=V(()=>{s(o),Le(n.current),n.current=Be(()=>s("black"),5e3)}),p=1+Math.floor(Math.random()*10);return m(xe,{catch:g=>{s(g.message),Le(n.current),n.current=Be(()=>s("black"),5e3)},children:E("div",{onpointerdown:l,onpointermove:l,style:{alignItems:"center",backgroundColor:c,borderRadius:"0.25rem",display:"flex",fontSize:"0.75rem",flexDirection:"column",gap:"0.25rem",justifyContent:"center",minWidth:"0",overflow:"hidden",padding:"0.25rem",textAlign:"center",transition:c==="black"?"all 5s":""},children:[m("select",{value:(Math.floor(Math.random()*p)+1).toString(),children:Array.from({length:p},(g,f)=>m("option",{value:(f+1).toString(),children:f+1},f))}),c==="red"?"Fake Render Error":c==="blue"?"Fake After Effect Error":c==="yellow"?"Fake Before Effect Error":m(mt,{children:r}),e===0&&t===0&&!!(r%5)&&m($,{to:Ke.getElementById("portal"),children:m(yt,{})})]})})}),vt=J(({index:e})=>E("div",{style:{borderTop:"10px solid #000",borderRight:"10px solid #000",padding:"1rem",display:"flex",alignItems:"center",justifyContent:"center",aspectRatio:"1",backgroundColor:$e(e)},children:["Item ",e+1]},e)),le=Se(0),je=1e4,Fe=()=>{let[e,t]=L(new Date().getSeconds()),[r,o]=L(Array.from({length:9},(g,f)=>f));P(()=>{let g=gt(()=>{t(new Date().getSeconds()),o(f=>f.toSorted(()=>Math.random()-.5))},1e3);return()=>ht(g)},[]);let n=F(null),{start:c,end:s,before:l,after:p}=De({containerRef:n,length:je});return E(le,{value:e,children:[m("div",{style:{boxSizing:"border-box",cursor:"crosshair",display:"grid",gap:"0.25rem",gridTemplate:`repeat(${C}, 1fr) / repeat(${C}, 1fr)`,height:"100%",padding:"0.25rem"},children:Array.from({length:C*C},(g,f)=>m(bt,{x:f%C,y:Math.floor(f/C)},f))}),m("div",{style:{boxSizing:"border-box",cursor:"crosshair",display:"grid",gap:"0.25rem",gridTemplate:"repeat(3, 1fr) / repeat(3, 1fr)",padding:"0.25rem"},children:r.map(g=>E("div",{style:{background:$e(g),borderRadius:"0.25rem",color:"white",display:"flex",padding:"0.5rem"},children:[E("div",{style:{flex:"1",padding:"0.5rem"},children:["Input ",g+1]}),m("input",{style:{display:"block",padding:"0.5rem",flex:"1",borderRadius:"0.25rem",border:"0"}})]},g))}),E("div",{style:{padding:"1rem"},children:[E("div",{style:{color:"#fff",fontWeight:"bold",marginBottom:"0.5rem"},children:[je," Items"]}),m("div",{"data-list-container":"true",ref:n,style:{color:"white",paddingTop:`${l}px`,paddingBottom:`${p}px`,display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(min(200px, 50%), 1fr))",borderLeft:"10px solid #000",borderBottom:"10px solid #000"},children:Array.from({length:s-c},(g,f)=>m(vt,{index:c+f},c+f))})]}),m("button",{onclick:()=>se(E("div",{style:{padding:"1rem",textAlign:"center"},children:[m("div",{style:{color:"white",marginBottom:"1rem"},children:"Unmounted!"}),m("button",{onclick:()=>se(m(Fe,{})),children:"Remount"})]})),style:{position:"fixed",bottom:"1rem",right:"1rem"},children:"Unmount"})]})},se=Me(Ke.getElementById("root").attachShadow({mode:"open"}));se(m(Fe,{}));})();
