"use strict";(()=>{var{console:qe,queueMicrotask:He,Element:Ie}=globalThis,p=(e,t,r)=>({type:e,props:t,key:r}),x=p;var he={},me={},Xe=p(me,he),ge={},Qe=[],Ye="moveBefore"in Ie.prototype?"moveBefore":"insertBefore",Ge="http://www.w3.org/2000/svg",Je=e=>qe.error(e),ye=e=>e==null||e===!1||e==="",N=e=>typeof e=="function",j=e=>typeof e=="object"&&e!==null,be=e=>e.children,W=e=>e.children,ve=e=>(E.catch=e.catch,e.children),we=e=>{let t=({value:r,children:o})=>{let s=E,h=S(()=>{let n={deps:new Set,value:r};return s.contexts=new Map(s.contexts).set(t,n),n});if(r!==h.value){h.value=r;for(let n of h.deps){n.state=1;let{parent:c}=n;for(;c&&c!==s&&!c.state;)c.state=2,{parent:c}=c}}return o};return t.value=e,t},Ze=(e,t,r)=>N(e)||e===me?null:e===ge?r.ownerDocument.createTextNode(t.nodeValue):r.ownerDocument.createElementNS(e==="svg"?Ge:"namespaceURI"in r?r.namespaceURI:r.host.namespaceURI,e),et=e=>e.nodeType===e.TEXT_NODE,ue=(e,t)=>t in e&&(e[t]==null||!j(e[t])),pe=(e,t,r)=>{if(et(e)){e.nodeValue=r.nodeValue;return}for(let o in t)o==="children"||o in r||(o==="ref"?t.ref&&(t.ref.current=null):ue(e,o)?e[o]="":e.removeAttribute(o));for(let o in r)if(!(o==="children"||t[o]===r[o]))if(o==="ref")t.ref&&(t.ref.current=null),r.ref&&(r.ref.current=e);else if(o==="style"&&j(r[o])){let{style:s}=e,h=j(t[o])?t[o]:{},n=r[o];for(let c in h)c in n||(s[c]="");for(let c in n)s[c]=n[c]??""}else ue(e,o)?e[o]=r[o]??"":r[o]!=null?e.setAttribute(o,r[o]):e.removeAttribute(o)},E=null,X=0,Q=0,F=e=>{let t=E;t.refs??=[];let r=t.refs[Q++];return r||(r={current:N(e)?e():e},t.refs.push(r)),r},z=(e,t)=>{let r=E;r.effects??=[];let o=r.effects[X++];o?(!o.deps||!t||xe(o.deps,t))&&(o.after=e,o.deps=t):r.effects.push({before:void 0,after:e,deps:t})},S=(e,t=Qe)=>{let r=F(()=>({value:e(),deps:t}));return xe(r.current.deps,t)&&(r.current.value=e(),r.current.deps=t),r.current.value},A=e=>{let t=E,r=S(()=>[N(e)?e():e,o=>{let s=N(o)?o(r[0]):o;return s!==r[0]&&(r[0]=s,ot(t)),s}]);return r},xe=(e,t)=>{if(e===t)return!1;let{length:r}=e;if(r!==t.length)return!0;for(;r--;)if(e[r]!==t[r])return!0;return!1},K=e=>{let t=F(()=>e);return t.current=e,S(()=>((...r)=>t.current.apply(null,r)))},tt=(e,t)=>{if(e===t)return!0;for(let r in e)if(e[r]!==t[r])return!1;for(let r in t)if(!(r in e))return!1;return!0},Y=(e,t=tt)=>(e.memo=t,e),te=e=>{let t=E,r=t.contexts?.get(e);return z(()=>{if(r)return r.deps.add(t),()=>r.deps.delete(t)},[r,t]),(r??e).value},rt=(e,t)=>{for(;e.depth>t.depth;)if(e=e.parent,e===t)return 1;for(;t.depth>e.depth;)if(t=t.parent,t===e)return-1;for(;e.parent!==t.parent;)e=e.parent,t=t.parent;return e.index-t.index},ot=e=>{if(e.state===1||e.state===3)return;let{queues:t}=e,{updates:r}=t;r.length===0&&He(()=>{let o=r.sort(rt);t.updates=[];for(let s of o)s.state===1&&re(s);Ce(t)}),r.push(e),e.state=1},nt=e=>{let{children:t}=e.props;if(N(e.type)){let r=[E,X,Q];E=e,X=0,Q=0;try{t=e.type(e.props)}catch(o){t=null,e.catch(o)}finally{[E,X,Q]=r}}return ye(t)?[]:Array.isArray(t)?t:[t]},st=e=>ye(e)?Xe:Array.isArray(e)?p(be,{children:e}):j(e)&&Object.keys(e).length===3&&(typeof e.type=="string"||N(e.type))&&j(e.props)&&"key"in e?e:p(ge,{nodeValue:e}),ke=e=>{let{child:t,state:r}=e;if(r===1)re(e);else if(r===2)for(e.state=0;t;t=t.sibling)ke(t)},Se=({child:e,node:t})=>{if(t)return[t];let r=[];for(;e;e=e.sibling)r.push.apply(r,Se(e));return r},re=e=>{let{depth:t,queues:r}=e,{afterEffects:o,inserts:s,nodeUpdates:h}=r,n=e.child,c=n&&new Map;for(;n;n=n.sibling)c.set(n.key??n.index,n);let b=e.node??e.parentNode,w=nt(e);if(e.effects)try{for(let m of e.effects)m.after&&m.before&&(m.before(),m.before=void 0)}catch(m){e.catch(m)}e.state=0,e.child=null;let u=e.node?null:e.prevNode;for(let m=0,f=null;m<w.length;++m){let{type:l,props:i,key:d}=st(w[m]),a=c?.get(d??m),g=null,R=!1;if(a?.type===l)c.delete(d??m),a.index=m,a.sibling=null,(!N(a.type)||!a.type.memo?.(a.props,i))&&(a.node&&(g=[a.node,a.props,i]),a.props=i,a.state=1),a.parentNode===b&&a.lastNode&&a.prevNode!==u&&(R=!0);else{try{a={catch:e.catch,child:null,contexts:e.contexts,depth:t+1,effects:null,index:m,key:d,lastNode:null,node:Ze(l,i,b),parent:e,parentNode:l===W?i.to:b,prevNode:l===W?i.to.lastChild:u,props:i,queues:r,refs:null,sibling:null,state:1,type:l}}catch(M){e.catch(M);continue}a.node&&(R=!0)}a.parentNode===b&&(a.prevNode=u),f?f.sibling=a:e.child=a,ke(a),g&&h.push(g),R&&s.push(a),a.parentNode===b&&a.lastNode&&(u=a.lastNode),f=a}if(e.lastNode=e.node??u??null,c)for(let m of c.values())Ee(m);e.effects&&o.push(e)},Ee=(e,t=!0)=>{e.state=3;let{effects:r,child:o,props:s,node:h}=e;if(r)try{for(let c of r)c.before&&(c.before(),c.before=void 0)}catch(c){e.catch(c)}let n=t&&!h;for(;o;o=o.sibling)Ee(o,n||o.type===W);h&&(s.ref&&(s.ref.current=null),t&&e.queues.removes.push(h))},Ce=e=>{for(let t of e.removes)t.remove();e.removes=[];for(let t of e.inserts){let{node:r,parentNode:o,prevNode:s,props:h}=t,n=s?s.nextSibling:o.firstChild;if(r&&!r.parentNode)pe(r,he,h),o.insertBefore(r,n);else for(let c of Se(t)){if(c===n||c.nextSibling===n)break;o[Ye](c,n)}}e.inserts=[];for(let t of e.nodeUpdates)pe.apply(null,t);e.nodeUpdates=[];for(let t of e.afterEffects)try{for(let r of t.effects)r.after&&(r.before=r.after(),r.after=void 0)}catch(r){t.catch(r)}e.afterEffects=[]},Re=e=>{let t={catch:Je,child:null,contexts:null,depth:0,effects:null,index:0,key:void 0,lastNode:null,node:null,parent:null,parentNode:e,prevNode:e.lastChild,props:{children:void 0},queues:{afterEffects:[],inserts:[],nodeUpdates:[],removes:[],updates:[]},refs:null,sibling:null,state:1,type:be};return r=>{t.props.children=r,re(t),Ce(t.queues)}};var Me=["anchor","archway","aurora","boulder","braid","bristle","canyon","cavern","chisel","cinder","cliffside","cobblestone","comet","compass","copper","crystal","current","drift","driftwood","dune","echo","echoes","echoing","ember","emberglow","forge","fossil","fractal","fresco","galaxy","gilded","glacier","groaning","grotto","grove","gust","harbor","harrow","harvest","hollow","horizon","horizonfall","iceberg","kettle","labyrinth","lantern","lichen","lilac","lumen","marble","meadow","meander","minaret","moss","mossy","nebula","oasis","orbit","orchard","peak","petal","pillar","prism","quill","quilt","reed","relic","ripple","rivet","rune","sandstone","seaway","serpent","shimmer","silken","soot","spiral","spire","spirelet","summit","summons","sunflare","talon","terrace","thicket","thistle","timber","torrent","traverse","tundra","turbine","tusk","vault","velvet","verdant","vessel","voyage","whisper","willow","windward","zephyr"],Te=()=>Me[Math.floor(Math.random()*Me.length)];var{document:P,getComputedStyle:lt,Document:Ne,ResizeObserver:ze,window:Ae,Window:ct}=globalThis,{body:Pe}=P,it=P.scrollingElement,V=Ae.visualViewport??Ae,at=10,ft={x:"clientWidth",y:"clientHeight"},dt={x:"innerWidth",y:"innerHeight"},ut={x:"overflowX",y:"overflowY"},oe={x:"right",y:"bottom"},Ue={x:"width",y:"height"},pt={x:"scrollWidth",y:"scrollHeight"},ht={x:"scrollLeft",y:"scrollTop"},mt=({axis:e,el:t})=>{for(;(t&&=t.parentElement)&&!(t===Pe||!Pe.contains(t));){if(t[pt[e]]<=t[ft[e]])continue;let r=lt(t)[ut[e]];if(r==="scroll"||r==="auto")return t}return P},De=({axis:e="y",containerRef:t,growBuffer:r=200,length:o=0,minIndex:s=0,shrinkBuffer:h=r+200})=>{let n=S(()=>({cache:{},columns:1,isRendering:!1,observed:null,observer:null,prev:{cache:{},minIndex:s,start:s},scrollParent:null,scrollTarget:null,syncUpdateCount:0,resolve:()=>{n.scrollTarget=null,n.syncUpdateCount=0}})),c=K(()=>{if(n.isRendering)return;let f=t.current,{end:l,start:i}=u;if(!f||i===l||f.children.length!==l-i)return n.resolve();let{cache:d,prev:a,scrollTarget:g}=n,R=u.start,M=[],k,y=1;for(let v of f.children){let ae=v.getBoundingClientRect(),fe=ae[Ue[e]];d[R++]=fe,M.push(fe);let de=ae[e];k==null?k=de:de===k&&++y}let Ke=M.sort()[Math.floor(M.length/2)];n.columns=y;let T=mt({axis:e,el:f});T!==n.scrollParent&&(n.scrollParent!==P&&n.scrollParent?.removeEventListener("scroll",c),T!==P&&T.addEventListener("scroll",c),n.scrollParent=T);let U=T instanceof Ne?it:T,D=ht[e],G=0,Ve=Math.min(a.minIndex,s),_e=Math.max(a.start,u.start);for(let v=Ve;v<_e;v+=y)G+=(d[v]??0)-(a.cache[v]??0);if(G&&(U[D]+=G),n.prev={cache:{...d},minIndex:s,start:u.start},n.syncUpdateCount++>at)return n.resolve();let J=f.getBoundingClientRect(),_=J[e]+u.before,O=J[oe[e]]-u.after,le=T instanceof Ne?{[e]:0,[oe[e]]:V instanceof ct?V[dt[e]]:V[Ue[e]]}:T.getBoundingClientRect(),q=le[e],Z=le[oe[e]],ee=s+o;for(let v=s;v<ee;++v)d[v]??=Ke;i-=(i-s)%y;let ce=(l-s)%y;for(ce&&(l+=y-ce);i-y>=s&&_>q-r;)_-=d[i-y],i-=y;for(;i<ee&&_+d[i]<=q-h;)_+=d[i],i+=y;for(;l<ee&&O<Z+r;)O+=d[l],l+=y;for(;l-y>=s&&O-d[l-y]>=Z+h;)O-=d[l-y],l-=y;let B=w({end:l,start:i});if(B.after!==u.after||B.before!==u.before||B.end!==u.end||B.start!==u.start)return n.isRendering=!0,m(B);if(!g)return n.resolve();let{index:L}=g;L=Math.min(s+o-1,Math.max(L,s)),L-=(L-s)%y;let ie=0;for(let v=s;v<L;v+=y)ie+=d[v];let H=U[D],Oe=d[L],$=J[e]+H-q+ie-g.buffer,I=$-(Z-q)+Oe+g.buffer*2;g.align==="nearest"&&($<I?g.align="center":H>$?g.align="start":H<I&&(g.align="end")),g.align==="start"?U[D]=$:g.align==="end"?U[D]=I:g.align==="center"&&(U[D]=($+I)/2),U[D]===H?n.resolve():c()}),b=K(({align:f="nearest",buffer:l=0,index:i})=>{n.scrollTarget={align:f,buffer:l,index:i},c()}),w=({end:f,start:l})=>{if(r===1/0)return{after:0,before:0,end:s+o,scrollTo:b,start:s};let{cache:i,columns:d}=n,a=s+o;l-=(l-s)%d,l=Math.min(a,Math.max(l,s));let g=(f-s)%d;g&&(f+=d-g),f=Math.min(a,Math.max(f,l)),f-l<=d&&(f<a?f=Math.min(a,f+d):l>s&&(l-=d));let R=0,M=0;for(let k=s;k<a;k+=d)k<l?R+=i[k]??0:k>=f&&(M+=i[k]??0);return{after:M,before:R,end:f,scrollTo:b,start:l}},[u,m]=A({after:0,before:0,end:0,scrollTo:b,start:0});return S(()=>{Object.assign(u,w({end:u.end,start:u.start}))},[o,s]),n.observer??=ze&&new ze(c),z(()=>{let{observed:f,observer:l}=n,i=t.current;l&&f!==i&&(f&&l.unobserve(f),i&&l.observe(i),n.observed=i),n.isRendering=!1,c()}),z(()=>{let{observer:f}=n;return V.addEventListener("resize",c),P.addEventListener("scroll",c),()=>{f?.disconnect(),V.removeEventListener("resize",c),P.removeEventListener("scroll",c),n.scrollParent?.removeEventListener("scroll",c)}},[n,c]),u};var{clearTimeout:Le,clearInterval:gt,document:We,setTimeout:Be,setInterval:yt}=globalThis,C=10,$e=new Intl.NumberFormat,je=e=>`rgb(${32+e*12%128}, ${32+e*23%128}, ${32+e*56%128})`,bt=({children:e})=>{if(Math.random()<.005)throw new Error("red");return z(()=>{if(Math.random()<.005)throw new Error("blue");return()=>{if(Math.random()<.005)throw new Error("yellow")}}),e},vt=Y(()=>x("div",{style:{background:"#fff9",borderRadius:"0.25rem",padding:"1rem"},children:["Portal: ",te(se)]})),wt=Y(({x:e,y:t})=>{let r=te(se),o=S(()=>`rgb(${128+(e-t)/C*128}, ${128+(t-e)/C*128}, ${(e+t)/C/2*256})`),s=F(void 0),[h,n]=A("black"),c=K(()=>{n(o),Le(s.current),s.current=Be(()=>n("black"),5e3)}),b=1+Math.floor(Math.random()*10);return p(ve,{catch:w=>{n(w.message),Le(s.current),s.current=Be(()=>n("black"),5e3)},children:x("div",{onpointerdown:c,onpointermove:c,style:{alignItems:"center",backgroundColor:h,borderRadius:"0.25rem",display:"flex",fontSize:"0.75rem",flexDirection:"column",gap:"0.25rem",justifyContent:"center",minWidth:"0",overflow:"hidden",padding:"0.25rem",textAlign:"center",transition:h==="black"?"all 5s":""},children:[p("select",{value:(Math.floor(Math.random()*b)+1).toString(),children:Array.from({length:b},(w,u)=>p("option",{value:(u+1).toString(),children:u+1},u))}),h==="red"?"Fake Render Error":h==="blue"?"Fake After Effect Error":h==="yellow"?"Fake Before Effect Error":p(bt,{children:r}),e===0&&t===0&&!!(r%5)&&p(W,{to:We.getElementById("portal"),children:p(vt,{})})]})})}),xt=Y(({item:{color:e,name:t,words:r}})=>x("div",{style:{borderTop:"10px solid #000",borderRight:"10px solid #000",padding:"1rem",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",aspectRatio:"1",backgroundColor:e},children:[p("div",{style:{fontWeight:"bold"},children:t}),r.map((o,s)=>p("div",{children:o},s))]})),se=we(0),kt=1e4,Fe=()=>{let[e,t]=A(new Date().getSeconds()),[r,o]=A(Array.from({length:9},(l,i)=>i)),[s,h]=A("");z(()=>{let l=yt(()=>{t(new Date().getSeconds()),o(i=>i.toSorted(()=>Math.random()-.5))},1e3);return()=>gt(l)},[]);let n=S(()=>Array.from({length:kt},(l,i)=>({color:je(i),id:i+1,name:`Item ${$e.format(i+1)}`,words:Array.from({length:3},Te)}))),c=S(()=>{if(!s)return n;let l=s.toLowerCase().split(/\s+/);return n.filter(i=>l.every(d=>i.words.some(a=>a.includes(d))))},[s]),b=F(null),{start:w,end:u,before:m,after:f}=De({containerRef:b,length:c.length});return x(se,{value:e,children:[p("div",{style:{boxSizing:"border-box",cursor:"crosshair",display:"grid",gap:"0.25rem",gridTemplate:`repeat(${C}, 1fr) / repeat(${C}, 1fr)`,height:"100%",padding:"0.25rem"},children:Array.from({length:C*C},(l,i)=>p(wt,{x:i%C,y:Math.floor(i/C)},i))}),p("div",{style:{boxSizing:"border-box",cursor:"crosshair",display:"grid",gap:"0.25rem",gridTemplate:"repeat(3, 1fr) / repeat(3, 1fr)",padding:"0.25rem"},children:r.map(l=>x("div",{style:{background:je(l),borderRadius:"0.25rem",color:"white",display:"flex",padding:"0.5rem"},children:[x("div",{style:{flex:"1",padding:"0.5rem"},children:["Input ",l+1]}),p("input",{style:{display:"block",padding:"0.5rem",flex:"1",borderRadius:"0.25rem",border:"0"}})]},l))}),x("div",{style:{padding:"1rem"},children:[x("div",{style:{marginBottom:"0.5rem",display:"flex",justifyContent:"space-between"},children:[x("div",{style:{color:"white",fontWeight:"bold"},children:[$e.format(c.length)," Items"]}),p("input",{placeholder:"Search",type:"search",value:s,oninput:l=>h(l.target.value),style:{borderRadius:"0.25rem",border:"0",padding:"0.5rem"}})]}),p("div",{style:{minHeight:"100vh"},children:p("div",{"data-list-container":"true",ref:b,style:{color:"white",paddingTop:`${m}px`,paddingBottom:`${f}px`,display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(min(200px, 50%), 1fr))",borderLeft:"10px solid #000",borderBottom:"10px solid #000"},children:Array.from({length:u-w},(l,i)=>{let d=c[w+i];return p(xt,{item:d},d.id)})})})]}),p("button",{onclick:()=>ne(x("div",{style:{padding:"1rem",textAlign:"center"},children:[p("div",{style:{color:"white",marginBottom:"1rem"},children:"Unmounted!"}),p("button",{onclick:()=>ne(p(Fe,{})),children:"Remount"})]})),style:{position:"fixed",bottom:"1rem",right:"1rem"},children:"Unmount"})]})},ne=Re(We.getElementById("root").attachShadow({mode:"open"}));ne(p(Fe,{}));})();
