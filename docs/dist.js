"use strict";(()=>{var{console:Ve,queueMicrotask:qe,Element:Ie}=globalThis,u=(e,t,r)=>({type:e,props:t,key:r}),x=u;var be={},ve={},Xe=u(ve,be),we={},He=[],Ye="moveBefore"in Ie.prototype?"moveBefore":"insertBefore",Qe="http://www.w3.org/2000/svg",Ge=e=>Ve.error(e),xe=e=>e==null||e===!1||e==="",A=e=>typeof e=="function",W=e=>typeof e=="object"&&e!==null,D=e=>e.children,j=e=>e.children,Se=e=>(R.catch=e.catch,e.children),ke=e=>{let t=({value:r,children:o})=>{let s=R,p=k(()=>{let n={deps:new Set,value:r};return s.contexts=new Map(s.contexts).set(t,n),n});if(r!==p.value){p.value=r;for(let n of p.deps){n.state=1;let{parent:c}=n;for(;c&&c!==s&&!c.state;)c.state=2,{parent:c}=c}}return o};return t.value=e,t},Je=(e,t,r)=>A(e)||e===ve?null:e===we?r.ownerDocument.createTextNode(t.nodeValue):r.ownerDocument.createElementNS(e==="svg"?Qe:"namespaceURI"in r?r.namespaceURI:r.host.namespaceURI,e),Ze=e=>e.nodeType===e.TEXT_NODE,ge=(e,t)=>t in e&&(e[t]==null||!W(e[t])),ye=(e,t,r)=>{if(Ze(e)){e.nodeValue=r.nodeValue;return}for(let o in t)o==="children"||o in r||(o==="ref"?t.ref&&(t.ref.current=null):ge(e,o)?e[o]="":e.removeAttribute(o));for(let o in r)if(!(o==="children"||t[o]===r[o]))if(o==="ref")t.ref&&(t.ref.current=null),r.ref&&(r.ref.current=e);else if(o==="style"&&W(r[o])){let{style:s}=e,p=W(t[o])?t[o]:{},n=r[o];for(let c in p)c in n||(s[c]="");for(let c in n)s[c]=n[c]??""}else ge(e,o)?e[o]=r[o]??"":r[o]!=null?e.setAttribute(o,r[o]):e.removeAttribute(o)},R=null,G=0,J=0,_=e=>{let t=R;t.refs??=[];let r=t.refs[J++];return r||(r={current:A(e)?e():e},t.refs.push(r)),r},$=(e,t)=>{let r=R;r.effects??=[];let o=r.effects[G++];o?(!o.deps||!t||Ce(o.deps,t))&&(o.after=e,o.deps=t):r.effects.push({before:void 0,after:e,deps:t})},k=(e,t=He)=>{let r=_(()=>({value:e(),deps:t}));return Ce(r.current.deps,t)&&(r.current.value=e(),r.current.deps=t),r.current.value},M=e=>{let t=R,r=k(()=>[A(e)?e():e,o=>{let s=A(o)?o(r[0]):o;return s!==r[0]&&(r[0]=s,rt(t)),s}]);return r},Ce=(e,t)=>{if(e===t)return!1;let{length:r}=e;if(r!==t.length)return!0;for(;r--;)if(e[r]!==t[r])return!0;return!1},K=e=>{let t=_(()=>e);return t.current=e,k(()=>((...r)=>t.current.apply(null,r)))},et=(e,t)=>{if(e===t)return!0;for(let r in e)if(e[r]!==t[r])return!1;for(let r in t)if(!(r in e))return!1;return!0},Z=(e,t=et)=>(e.memo=t,e),ne=e=>{let t=R,r=t.contexts?.get(e);return $(()=>{if(r)return r.deps.add(t),()=>r.deps.delete(t)},[r,t]),(r??e).value},tt=(e,t)=>{for(;e.depth>t.depth;)if(e=e.parent,e===t)return 1;for(;t.depth>e.depth;)if(t=t.parent,t===e)return-1;for(;e.parent!==t.parent;)e=e.parent,t=t.parent;return e.index-t.index},rt=e=>{if(e.state===1||e.state===3)return;let{queues:t}=e,{updates:r}=t;r.length===0&&qe(()=>{let o=r.sort(tt);t.updates=[];for(let s of o)s.state===1&&se(s);Ee(t)}),r.push(e),e.state=1},ot=e=>{let{children:t}=e.props;if(A(e.type)){let r=[R,G,J];R=e,G=0,J=0;try{t=e.type(e.props)}catch(o){t=null,e.catch(o)}finally{[R,G,J]=r}}return xe(t)?[]:Array.isArray(t)?t:[t]},nt=e=>xe(e)?Xe:Array.isArray(e)?u(D,{children:e}):W(e)&&(typeof e.type=="string"||A(e.type))&&W(e.props)&&"key"in e?e:u(we,{nodeValue:e}),Re=e=>{let{child:t,state:r}=e;if(r===1)se(e);else if(r===2)for(e.state=0;t;t=t.sibling)Re(t)},se=e=>{let{depth:t,queues:r}=e,{afterEffects:o,inserts:s,nodeUpdates:p}=r,n=e.child,c=n&&new Map;for(;n;n=n.sibling)c.set(n.key??n.index,n);let y=e.node??e.parentNode,a=ot(e);if(e.effects)try{for(let g of e.effects)g.after&&g.before&&(g.before(),g.before=void 0)}catch(g){e.catch(g)}e.state=0,e.child=null;let h=e.node?null:e.prevNode;for(let g=0,d=null;g<a.length;++g){let{type:l,props:i,key:m}=nt(a[g]),f=c?.get(m??g),b=null,T=!1;if(f?.type===l)c.delete(m??g),f.index=g,f.sibling=null,(!A(f.type)||!f.type.memo?.(f.props,i))&&(f.node&&(b=[f.node,f.props,i]),f.props=i,f.state=1),f.parentNode===e.node&&f.lastNode&&f.prevNode!==h&&(T=!0);else{try{f={catch:e.catch,child:null,contexts:e.contexts,depth:t+1,effects:null,index:g,key:m,lastNode:null,node:Je(l,i,y),parent:e,parentNode:l===j?i.to:y,prevNode:l===j?i.to.lastChild:h,props:i,queues:r,refs:null,sibling:null,state:1,type:l}}catch(z){e.catch(z);continue}f.node&&(T=!0)}f.parentNode===y&&(f.prevNode=h),d?d.sibling=f:e.child=f,Re(f),b&&p.push(b),T&&s.push(f),f.parentNode===y&&f.lastNode&&(h=f.lastNode),d=f}if(e.lastNode=e.node??h??null,c)for(let g of c.values())Me(g);e.effects&&o.push(e)},Me=(e,t=!0)=>{e.state=3;let{effects:r,child:o,props:s,node:p}=e;if(r)try{for(let c of r)c.before&&(c.before(),c.before=void 0)}catch(c){e.catch(c)}let n=t&&!p;for(;o;o=o.sibling)Me(o,n||o.type===j);p&&(s.ref&&(s.ref.current=null),t&&e.queues.removes.push(p))},Ee=e=>{for(let t of e.removes)t.remove();e.removes=[];for(let t of e.inserts){let{parentNode:r,prevNode:o,props:s}=t,p=o?o.nextSibling:r.firstChild;for(let n=t;n;){let{node:c}=n;if(c){if(!c.parentNode){ye(c,be,s),r.insertBefore(c,p);break}if(c===p||c.nextSibling===p||(r[Ye](c,p),n===t))break}if(n.child&&!c)n=n.child;else if(n.sibling)n=n.sibling;else{for(;n!==t&&n.parent&&!n.sibling;)n=n.parent;if(n===t)break;n=n.sibling}}}e.inserts=[];for(let t of e.nodeUpdates)ye.apply(null,t);e.nodeUpdates=[];for(let t of e.afterEffects)try{for(let r of t.effects)r.after&&(r.before=r.after(),r.after=void 0)}catch(r){t.catch(r)}e.afterEffects=[]},Te=e=>{let t={catch:Ge,child:null,contexts:null,depth:0,effects:null,index:0,key:void 0,lastNode:null,node:null,parent:null,parentNode:e,prevNode:e.lastChild,props:{children:void 0},queues:{afterEffects:[],inserts:[],nodeUpdates:[],removes:[],updates:[]},refs:null,sibling:null,state:1,type:D};return r=>{t.props.children=r,se(t),Ee(t.queues)}};var ze=["anchor","archway","aurora","boulder","braid","bristle","canyon","cavern","chisel","cinder","cliffside","cobblestone","comet","compass","copper","crystal","current","drift","driftwood","dune","echo","echoes","echoing","ember","emberglow","forge","fossil","fractal","fresco","galaxy","gilded","glacier","groaning","grotto","grove","gust","harbor","harrow","harvest","hollow","horizon","horizonfall","iceberg","kettle","labyrinth","lantern","lichen","lilac","lumen","marble","meadow","meander","minaret","moss","mossy","nebula","oasis","orbit","orchard","peak","petal","pillar","prism","quill","quilt","reed","relic","ripple","rivet","rune","sandstone","seaway","serpent","shimmer","silken","soot","spiral","spire","spirelet","summit","summons","sunflare","talon","terrace","thicket","thistle","timber","torrent","traverse","tundra","turbine","tusk","vault","velvet","verdant","vessel","voyage","whisper","willow","windward","zephyr"],Ne=()=>ze[Math.floor(Math.random()*ze.length)];var{document:L,getComputedStyle:st,Document:$e,ResizeObserver:lt,window:Ae,Window:it}=globalThis,{body:ct}=L,at=L.scrollingElement,V=Ae.visualViewport??Ae,ft=10,dt={x:"clientWidth",y:"clientHeight"},ut={x:"innerWidth",y:"innerHeight"},pt={x:"overflowX",y:"overflowY"},le={x:"right",y:"bottom"},Le={x:"width",y:"height"},ht={x:"scrollWidth",y:"scrollHeight"},mt={x:"scrollLeft",y:"scrollTop"},gt=({axis:e,el:t})=>{for(;(t&&=t.parentElement)&&t!==ct;){if(t[ht[e]]<=t[dt[e]])continue;let r=st(t)[pt[e]];if(r==="scroll"||r==="auto")return t}return L},Pe=({axis:e="y",containerRef:t,growBuffer:r=200,length:o=0,minIndex:s=0,shrinkBuffer:p=r+200})=>{let n=K(()=>{if(a.isRendering)return;let d=t.current,{end:l,start:i}=h;if(!d||i===l||d.children.length!==l-i)return a.resolve();let{cache:m,prev:f,scrollTarget:b}=a,T=h.start,z=[],S,v=1;for(let w of d.children){let pe=w.getBoundingClientRect(),he=pe[Le[e]];m[T++]=he,z.push(he);let me=pe[e];S==null?S=me:me===S&&++v}let Oe=z.sort()[Math.floor(z.length/2)];a.columns=v;let N=gt({axis:e,el:d});N!==a.scrollParent&&(a.scrollParent!==L&&a.scrollParent?.removeEventListener("scroll",n),N!==L&&N.addEventListener("scroll",n),a.scrollParent=N);let P=N instanceof $e?at:N,U=mt[e],ee=0,We=Math.min(f.minIndex,s),je=Math.max(f.start,h.start);for(let w=We;w<je;w+=v)ee+=(m[w]??0)-(f.cache[w]??0);if(ee&&(P[U]+=ee),a.prev={cache:{...m},minIndex:s,start:h.start},a.syncUpdateCount++>ft)return a.resolve();let te=d.getBoundingClientRect(),I=te[e]+h.before,X=te[le[e]]-h.after,fe=N instanceof $e?{[e]:0,[le[e]]:V instanceof it?V[ut[e]]:V[Le[e]]}:N.getBoundingClientRect(),H=fe[e],re=fe[le[e]],oe=s+o;for(let w=s;w<oe;++w)m[w]??=Oe;i-=(i-s)%v;let de=(l-s)%v;for(de&&(l+=v-de);i-v>=s&&I>H-r;)I-=m[i-v],i-=v;for(;i<oe&&I+m[i]<=H-p;)I+=m[i],i+=v;for(;l<oe&&X<re+r;)X+=m[l],l+=v;for(;l-v>=s&&X-m[l-v]>=re+p;)X-=m[l-v],l-=v;let F=y({end:l,start:i});if(F.after!==h.after||F.before!==h.before||F.end!==h.end||F.start!==h.start)return a.isRendering=!0,g(F);if(!b)return a.resolve();let{index:B}=b;B=Math.min(s+o-1,Math.max(B,s)),B-=(B-s)%v;let ue=0;for(let w=s;w<B;w+=v)ue+=m[w];let Y=P[U],Ke=m[B],O=te[e]+Y-H+ue-b.buffer,Q=O-(re-H)+Ke+b.buffer*2;b.align==="nearest"&&(O<Q?b.align="center":Y>O?b.align="start":Y<Q&&(b.align="end")),b.align==="start"?P[U]=O:b.align==="end"?P[U]=Q:b.align==="center"&&(P[U]=(O+Q)/2),P[U]===Y?a.resolve():n()}),c=K(({align:d="nearest",buffer:l=0,index:i})=>{a.scrollTarget={align:d,buffer:l,index:i},n()}),y=({end:d,start:l})=>{if(r===1/0)return{after:0,before:0,end:s+o,scrollTo:c,start:s};let{cache:i,columns:m}=a,f=s+o;l-=(l-s)%m,l=Math.min(f,Math.max(l,s));let b=(d-s)%m;b&&(d+=m-b),d=Math.min(f,Math.max(d,l)),d-l<=m&&(d<f?d=Math.min(f,d+m):l>s&&(l-=m));let T=0,z=0;for(let S=s;S<f;S+=m)S<l?T+=i[S]??0:S>=d&&(z+=i[S]??0);return{after:z,before:T,end:d,scrollTo:c,start:l}},a=k(()=>({cache:{},columns:1,isRendering:!1,observed:null,observer:new lt(n),prev:{cache:{},minIndex:s,start:s},scrollParent:null,scrollTarget:null,syncUpdateCount:0,resolve:()=>{a.scrollTarget=null,a.syncUpdateCount=0}})),[h,g]=M({after:0,before:0,end:0,scrollTo:c,start:0});return k(()=>{Object.assign(h,y({end:h.end,start:h.start}))},[o,s]),$(()=>{let{observed:d,observer:l}=a,i=t.current;l&&d!==i&&(d&&l.unobserve(d),i&&l.observe(i),a.observed=i),a.isRendering=!1,n()}),$(()=>{let{observer:d}=a;return V.addEventListener("resize",n),L.addEventListener("scroll",n),()=>{d?.disconnect(),V.removeEventListener("resize",n),L.removeEventListener("scroll",n),a.scrollParent?.removeEventListener("scroll",n)}},[a,n]),h};var{clearTimeout:Ue,clearInterval:yt,document:_e,ResizeObserver:bt,setTimeout:Be,setInterval:vt}=globalThis,E=10,ie=new Intl.NumberFormat,De=e=>`rgb(${32+e*12%128}, ${32+e*23%128}, ${32+e*56%128})`,wt=({children:e})=>{if(Math.random()<.005)throw new Error("red");return $(()=>{if(Math.random()<.005)throw new Error("blue");return()=>{if(Math.random()<.005)throw new Error("yellow")}}),e},xt=Z(()=>x("div",{style:{background:"#fff9",borderRadius:"0.25rem",padding:"1rem"},children:["Portal: ",ne(ae)]})),St=Z(({x:e,y:t})=>{let r=ne(ae),o=k(()=>`rgb(${128+(e-t)/E*128}, ${128+(t-e)/E*128}, ${(e+t)/E/2*256})`),s=_(void 0),[p,n]=M("black"),c=K(()=>{n(o),Ue(s.current),s.current=Be(()=>n("black"),5e3)}),y=1+Math.floor(Math.random()*10);return u(Se,{catch:a=>{n(a.message),Ue(s.current),s.current=Be(()=>n("black"),5e3)},children:x("div",{onpointerdown:c,onpointermove:c,style:{alignItems:"center",backgroundColor:p,borderRadius:"0.25rem",display:"flex",fontSize:"0.75rem",flexDirection:"column",gap:"0.25rem",justifyContent:"center",minWidth:"0",overflow:"hidden",padding:"0.25rem",textAlign:"center",transition:p==="black"?"all 5s":""},children:[u("select",{value:(Math.floor(Math.random()*y)+1).toString(),children:Array.from({length:y},(a,h)=>u("option",{value:(h+1).toString(),children:h+1},h))}),p==="red"?"Fake Render Error":p==="blue"?"Fake After Effect Error":p==="yellow"?"Fake Before Effect Error":u(wt,{children:r}),e===0&&t===0&&!!(r%5)&&u(j,{to:_e.getElementById("portal"),children:u(xt,{})})]})})}),q=Math.ceil(Math.sqrt(1e9)),C=50,kt=()=>{let e=_(null),[{xOffset:t,yOffset:r,xSize:o,ySize:s},p]=M({xOffset:0,yOffset:0,xSize:0,ySize:0}),[n,c]=M(new Set);return $(()=>{let y=e.current;if(!y)return;let a=()=>{let g=y.getBoundingClientRect(),d=Math.max(0,Math.floor(y.scrollLeft/C)),l=Math.max(0,Math.floor(y.scrollTop/C));p({xOffset:d,yOffset:l,xSize:Math.min(q-d,Math.ceil((g.width+20)/C)),ySize:Math.min(q-l,Math.ceil((g.height+20)/C))})},h=new bt(a);return y.onscroll=a,a(),()=>h.disconnect()},[]),x(D,{children:[x("div",{style:{padding:"10px",color:"white",fontWeight:"bold"},children:[ie.format(q**2)," Checkboxes"]}),u("div",{ref:e,style:{border:"10px solid white",borderRadius:"10px",height:"50vh",overflow:"auto"},children:u("div",{style:{boxSizing:"border-box",paddingLeft:`${t*C}px`,paddingTop:`${r*C}px`,width:`${q*C}px`,height:`${q*C}px`},children:Array.from({length:s},(y,a)=>u("div",{children:Array.from({length:o},(h,g)=>u("input",{style:{margin:"0",padding:"0",border:"0",width:`${C}px`,height:`${C}px`,verticalAlign:"bottom"},type:"checkbox",checked:n.has(`${t+g},${r+a}`),oninput:d=>c(l=>{let i=new Set(l);return d.target.checked?i.add(`${t+g},${r+a}`):i.delete(`${t+g},${r+a}`),i})},g.toString()))},a.toString()))})})]})},Ct=Z(({item:{color:e,name:t,words:r}})=>x("div",{style:{borderTop:"10px solid #000",borderRight:"10px solid #000",padding:"1rem",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",aspectRatio:"1",backgroundColor:e},children:[u("div",{style:{fontWeight:"bold"},children:t}),r.map((o,s)=>u("div",{children:o},s))]})),ae=ke(0),Rt=1e4,Fe=()=>{let[e,t]=M(new Date().getSeconds()),[r,o]=M(Array.from({length:10},(l,i)=>i)),[s,p]=M("");$(()=>{let l=vt(()=>{t(new Date().getSeconds()),o(i=>i.toSorted(()=>Math.random()-.5))},1e3);return()=>yt(l)},[]);let n=k(()=>Array.from({length:Rt},(l,i)=>({color:De(i),id:i+1,name:`Item ${ie.format(i+1)}`,words:Array.from({length:3},Ne)}))),c=k(()=>{if(!s)return n;let l=s.toLowerCase().split(/\s+/);return n.filter(i=>l.every(m=>i.words.some(f=>f.includes(m))))},[s]),y=_(null),{start:a,end:h,before:g,after:d}=Pe({containerRef:y,length:c.length});return x(ae,{value:e,children:[u("div",{style:{boxSizing:"border-box",cursor:"crosshair",display:"grid",gap:"0.25rem",gridTemplate:`repeat(${E}, 1fr) / repeat(${E}, 1fr)`,height:"50vh",padding:"0.25rem"},children:Array.from({length:E*E},(l,i)=>u(St,{x:i%E,y:Math.floor(i/E)},i))}),u("div",{style:{boxSizing:"border-box",cursor:"crosshair",display:"grid",gap:"0.25rem",gridTemplateColumns:"repeat(2, 1fr)",padding:"1rem"},children:r.map(l=>x(D,{children:[x("div",{style:{background:De(l),borderBottomLeftRadius:"0.25rem",borderTopLeftRadius:"0.25rem",color:"white",display:"flex",padding:"0.5rem"},children:["Input ",l+1]}),u("input",{placeholder:`Input ${l+1}`,style:{border:"0",borderBottomRightRadius:"0.25rem",borderTopRightRadius:"0.25rem",display:"block",flex:"1",padding:"0.5rem"}})]},l))}),x("div",{style:{padding:"1rem"},children:[x("div",{style:{marginBottom:"0.5rem",display:"flex",justifyContent:"space-between"},children:[x("div",{style:{color:"white",fontWeight:"bold"},children:[ie.format(c.length)," Items"]}),u("input",{placeholder:"Search",type:"search",value:s,oninput:l=>p(l.target.value),style:{borderRadius:"0.25rem",border:"0",padding:"0.5rem"}})]}),u("div",{style:{border:"10px solid white",borderRadius:"10px",height:"50vh",overflow:"auto"},children:u("div",{"data-list-container":"true",ref:y,style:{color:"white",paddingTop:`${g}px`,paddingBottom:`${d}px`,display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(min(200px, 50%), 1fr))",borderLeft:"10px solid #000",borderBottom:"10px solid #000"},children:Array.from({length:h-a},(l,i)=>{let m=c[a+i];return u(Ct,{item:m},m.id)})})}),u(kt,{})]}),u("button",{onclick:()=>ce(x("div",{style:{padding:"1rem",textAlign:"center"},children:[u("div",{style:{color:"white",marginBottom:"1rem"},children:"Unmounted!"}),u("button",{onclick:()=>ce(u(Fe,{})),children:"Remount"})]})),style:{position:"fixed",bottom:"1rem",right:"1rem"},children:"Unmount"}),u("my-custom-element",{myCustomProp:"foo"})]})},ce=Te(_e.getElementById("root").attachShadow({mode:"open"}));ce(u(Fe,{}));})();
