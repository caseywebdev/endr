"use strict";(()=>{var{console:ne,document:V,queueMicrotask:oe,Text:se}=globalThis,i=(e,t=B,r)=>({type:e,props:t,key:r}),T=i;var F=e=>e.children,j=e=>e.children,Q=e=>(a.catch=e.catch,e.children),$=()=>{let e=({value:t,children:r})=>{let n=a,s=N(()=>{let l={deps:new Set,value:t};return n.contexts=new Map(n.contexts).set(e,l),l});if(t!==s.value){s.value=t;for(let l of s.deps){l.state=1;let{parent:o}=l;for(;o&&o!==n&&!o.state;)o.state=2,{parent:o}=o}}return r};return e},U=e=>e==null||e===!1||e==="",B={},q={},ce={type:q,props:B,key:void 0},z={},le=[],fe="http://www.w3.org/2000/svg",ie=e=>ne.error(e),ue=(e,t,r)=>{if(typeof e=="function"||e===q)return null;if(e===z)return V.createTextNode(t.nodeValue);let n=V.createElementNS(e==="svg"?fe:r.namespaceURI,e);return O(n,{},t),n},v=(e,t)=>t in e&&(e[t]==null||typeof e[t]!="object"),ae=(e,t,r)=>{for(let n in t)n in r||(e[n]="");for(let n in r)e[n]=r[n]??""},O=(e,t,r)=>{if(e instanceof se){e.nodeValue=r.nodeValue;return}for(let n in t)n==="children"||n in r||(n==="ref"?t.ref&&(t.ref.current=null):v(e,n)?e[n]="":e.removeAttribute(n));for(let n in r)n==="children"||t[n]===r[n]||(n==="ref"?(t.ref&&(t.ref.current=null),r.ref&&(r.ref.current=e)):n==="style"&&r[n]&&typeof r[n]=="object"?ae(e.style,t[n]&&typeof t[n]=="object"?t[n]:{},r[n]):v(e,n)?e[n]=r[n]??"":r[n]!=null?e.setAttribute(n,r[n]):e.removeAttribute(n))},a=null,_=0,G=0,h=[],y=[],g=[],m=[],b=[],d=[],M=e=>{let t=a;t.refs??=[];let r=t.refs[G++];return r||(r={current:e},t.refs.push(r)),r},w=(e,t)=>{let r=a;r.effects??=[];let n=r.effects[_++];n?(!n.deps||!t||H(n.deps,t))&&(n.after=e,n.deps=t):r.effects.push({before:void 0,after:e,deps:t})},N=(e,t=le)=>{let r=M(null);return r.current?H(r.current.deps,t)&&(r.current.value=e(),r.current.deps=t):r.current={value:e(),deps:t},r.current.value},A=e=>{let t=a,r=N(()=>[e,n=>{let s=typeof n=="function"?n(r[0]):n;return s===r[0]||(r[0]=s,he(t)),s}]);return r},H=(e,t)=>{let{length:r}=e;if(r!==t.length)return!0;for(;r--;)if(e[r]!==t[r])return!0;return!1};var pe=(e,t)=>{if(e===t)return!0;for(let r in e)if(e[r]!==t[r])return!1;for(let r in t)if(!(r in e))return!1;return!0},J=(e,t=pe)=>(e.memo=t,e),D=e=>{let t=a,r=t.contexts?.get(e);return w(()=>{if(r)return r.deps.add(t),()=>r.deps.delete(t)},[r,t]),r?.value},de=(e,t)=>{for(;e.depth>t.depth;)if(e=e.parent,e===t)return 1;for(;t.depth>e.depth;)if(t=t.parent,t===e)return-1;for(;e.parent!==t.parent;)e=e.parent,t=t.parent;return e.index-t.index},he=e=>{e.state===1||e.state===3||(d.length===0&&oe(()=>{let t=d.sort(de);d=[];for(let r=0;r<t.length;++r){let n=t[r];n.state===1&&I(n)}X()}),d.push(e),e.state=1)},ye=e=>{let{children:t}=e.props;if(typeof e.type=="function"){a=e,_=0,G=0;try{t=e.type(e.props)}catch(r){t=null,e.catch(r)}}return U(t)?[]:Array.isArray(t)?t:[t]},ge=e=>U(e)?ce:Array.isArray(e)?{type:F,props:{children:e},key:void 0}:e&&typeof e=="object"&&Object.keys(e).length===3&&"type"in e&&(typeof e.type=="string"||typeof e.type=="function")&&"props"in e&&e.props&&typeof e.props=="object"&&"key"in e?e:{type:z,props:{nodeValue:e},key:void 0},K=(e,t,r,n,s,l)=>({child:null,contexts:n?.contexts??null,depth:n?n.depth+1:0,effects:null,index:l,key:r,lastNode:null,node:ue(e,t,s),catch:n?.catch??ie,parent:n,parentNode:s,prevNode:null,props:t,refs:null,sibling:null,state:1,type:e}),L=e=>{let{child:t,state:r}=e;if(r===1)I(e);else if(r===2)for(e.state=0;t;t=t.sibling)L(t)},x=({child:e,node:t})=>{if(t)return[t];let r=[];for(;e;e=e.sibling)r.push(...x(e));return r},I=e=>{if(e.effects)try{for(let o=0;o<e.effects.length;++o){let f=e.effects[o];f.after&&f.before&&(f.before(),f.before=void 0)}}catch(o){e.catch(o)}let t=e.child,r=t&&new Map;for(;t;t=t.sibling)r.set(t.key??t.index,t);let n=e.node??e.parentNode,s=ye(e);e.state=0,e.child=null;let l=e.node?null:e.prevNode;for(let o=0,f=null;o<s.length;++o){let{type:k,props:p,key:C}=ge(s[o]),c=r?.get(C??o),P=!1,E=null,R=!1;if(c?.type===k)r.delete(C??o),c.index=o,c.sibling=null,(typeof c.type!="function"||!c.type.memo?.(c.props,p))&&(c.node&&(E=[c.node,c.props,p]),c.props=p,c.state=1),c.parentNode===n&&c.lastNode&&l!==c.prevNode&&(P=!0);else{try{c=K(k,p,C,e,k===j?p.to:n,o)}catch(re){e.catch(re);continue}c.node&&(R=!0)}c.parentNode===n&&(c.prevNode=l),f?f.sibling=c:e.child=c,L(c),P&&y.push(c),E&&g.push(E),R&&m.push(c),c.parentNode===n&&c.lastNode&&(l=c.lastNode),f=c}if(e.lastNode=e.node??l??null,r)for(let o of r.values())W(o,!0);e.effects&&b.push(e)},W=(e,t)=>{e.state=3;let{effects:r,child:n,node:s}=e;if(r)try{for(let o=0;o<r.length;++o){let f=r[o];f.before&&(f.before(),f.before=void 0)}}catch(o){e.catch(o)}let l=t&&!s;for(;n;n=n.sibling)W(n,l);t&&s&&h.unshift(s)},X=()=>{for(let e=h.length-1;e>=0;--e)h[e].remove();h=[];for(let e=0;e<y.length;++e){let t=y[e];t.prevNode?t.prevNode.after(...x(t)):t.parentNode.prepend(...x(t))}y=[];for(let e=0;e<g.length;++e)O(...g[e]);g=[];for(let e=0;e<m.length;++e){let t=m[e];t.prevNode?t.prevNode.after(t.node):t.parentNode.prepend(t.node)}m=[];for(let e=0;e<b.length;++e){let t=b[e],r=t.effects;try{for(let n=0;n<r.length;++n){let s=r[n];s.after&&(s.before=s.after(),s.after=void 0)}}catch(n){t.catch(n)}}b=[]},Y=(e,t)=>{I(K(F,{children:e},void 0,null,t,0)),X()};var{clearTimeout:Z,document:te,setTimeout:ee,setInterval:me}=globalThis,u=10,be=({children:e})=>{if(Math.random()<.01)throw new Error("red");return w(()=>{if(Math.random()<.01)throw new Error("blue");return()=>{if(Math.random()<.01)throw new Error("yellow")}}),e},we=J(({x:e,y:t})=>{let r=D(S)??0,n=N(()=>`rgb(${128+(e-t)/u*128}, ${128+(t-e)/u*128}, ${(e+t)/u/2*256})`),s=M(void 0),[l,o]=A("black");return i(Q,{catch:f=>{o(f.message),Z(s.current),s.current=ee(()=>o("black"),5e3)},children:T("div",{onpointermove:()=>{o(n),Z(s.current),s.current=ee(()=>o("black"),5e3)},ontouchmove:f=>f.preventDefault(),style:{backgroundColor:l,transition:l==="black"?"all 5s":"",display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden"},children:[l==="red"?"Fake Render Error":l==="blue"?"Fake After Effect Error":l==="yellow"?"Fake Before Effect Error":i(be,{children:r}),e===1&&t===1&&!!(r%5)&&i(Ne,{})]})})}),Ne=()=>{let e=D(S);return i(j,{to:te.getElementById("portal"),children:T("div",{style:{background:"#fff9",borderRadius:"0.25rem",padding:"1rem"},children:["Portal: ",e]})})},S=$(),ke=()=>{let[e,t]=A(new Date().getSeconds());return w(()=>{me(()=>t(new Date().getSeconds()),1e3)}),i(S,{value:e,children:i("div",{style:{cursor:"crosshair",display:"grid",gridTemplate:`repeat(${u}, 1fr) / repeat(${u}, 1fr)`,height:"100%"},children:Array.from({length:u*u},(r,n)=>i(we,{x:n%u,y:Math.floor(n/u)},n))})})};Y(i(ke,{}),te.getElementById("root"));})();
